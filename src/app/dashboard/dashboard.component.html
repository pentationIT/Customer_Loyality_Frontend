<!-- the below commented part is the common template for all the pages which have a side nav -->

<!-- <ng-container>
    <div class="row">
        <div class="sidenav"   [ngClass]="(sideNavOpen == false)?'sidenav_close':''">
        </div>
        <div class="mainArea"  [ngClass]="(sideNavOpen == false)?'mainArea_max':''">

            <button class="toogleSidenav" (click)="sideNavOpen = !sideNavOpen"  [ngClass]="(sideNavOpen == false)?'toogleSidenav_close':''">
                <i *ngIf="sideNavOpen" class="fa fa-arrow-left"></i>
                <i *ngIf="!sideNavOpen" class="fa fa-arrow-right"></i>
            </button>
           
        </div>
    </div>
</ng-container> -->

<!-- <mat-spinner></mat-spinner> -->

<ng-container>
    <div class="row">
        <div class="sidenav"   [ngClass]="(sideNavOpen == false)?'sidenav_close':''">
            <div class="row filterButtonArea" style=" width:100%!important;height: 100%; overflow-y: scroll;">

                    <div class="col-12 mainMenu" style="background-color: #053b5a!important; color: #ffffff; padding:15px;padding-bottom: 10px; font-size: 12px;">

                        

                        <div class="multiselectFilter" *ngIf="aopChecked == false">
                            <!-- <span class="filterLabel" >CATEGORY</span> -->
                            <ng-multiselect-dropdown
                                [placeholder]="'CATEGORY'"
                                [settings]="category_dropdownSettings"
                                [data]="category_dropdownList"
                                [(ngModel)]="category_selectedItems"
                                (onSelect)="show_Hide_monthYear_list()"
                                (onDeSelect)="show_Hide_monthYear_list()"
                                >
                            </ng-multiselect-dropdown>
                        </div>

                        

                        <div *ngIf="show_monthList && aopChecked == false" class="multiselectFilter" >
                            <!-- <span class="filterLabel" >MONTH YEAR</span> -->
                            <ng-multiselect-dropdown
                                [placeholder]="'MONTH YEAR'"
                                [settings]="month_dropdownSettings"
                                [data]="month_dropdownList"
                                [(ngModel)]="month_selectedItems"
                                >
                            </ng-multiselect-dropdown>
                        </div>

                        <div class="multiselectFilter" >
                            <!-- <span class="filterLabel">BUSINESS CATEGORY</span> -->
                            <ng-multiselect-dropdown 
                            [placeholder]="'BUSINESS CATEGORY'"
                            [settings]="businessCategory_dropdownSettings"
                            [data]="businessCategory_dropdownList"
                            [(ngModel)]="businessCategory_selectedItems"                        
                            >
                            </ng-multiselect-dropdown>
                        </div>

                        
                        <div class="multiselectFilter">
                            <!-- <span class="filterLabel" >MAIN CHANNEL</span> -->
                            <ng-multiselect-dropdown
                                [placeholder]="'MAIN CHANNEL'"
                                [settings]="mainChannel_dropdownSettings"
                                [data]="mainChannel_dropdownList"
                                [(ngModel)]="mainChannel_selectedItems"

                                (onSelect)="get_subChannelCodeName_list();get_imdChannel_list();get_imdCodeName_list();"
                                (onSelectAll)="get_subChannelCodeName_list();get_imdChannel_list();get_imdCodeName_list();"
                                (onDeSelect)="get_subChannelCodeName_list();get_imdChannel_list();get_imdCodeName_list();"
                                (onDeSelectAll)="get_subChannelCodeName_list();get_imdChannel_list();get_imdCodeName_list();"
                                
                                >
                            </ng-multiselect-dropdown>
                        </div>

                       

                        <div class="multiselectFilter">
                            <!-- <span class="filterLabel" >IMD CHANNEL</span> -->
                            <ng-multiselect-dropdown
                                [placeholder]="'IMD CHANNEL'"
                                [settings]="imdChannel_dropdownSettings"
                                [data]="imdChannel_dropdownList"
                                [(ngModel)]="imdChannel_selectedItems"

                                (onSelect)="get_subChannelCodeName_list();get_imdCodeName_list();"
                                (onSelectAll)="get_subChannelCodeName_list();get_imdCodeName_list();"
                                (onDeSelect)="get_subChannelCodeName_list();get_imdCodeName_list();"
                                (onDeSelectAll)="get_subChannelCodeName_list();get_imdCodeName_list();"

                                >
                            </ng-multiselect-dropdown>
                        </div>

                        <!-- <div class="multiselectFilter">
                            <span class="filterLabel" >Imd Channel</span>
                            <ng-multiselect-dropdown
                                [placeholder]="'IMD CHANNEL'"
                                [settings]="imdChannel_dropdownSettings"
                                [data]="imdChannel_dropdownList"
                                [(ngModel)]="imdChannel_selectedItems"
                                (onSelect)="get_subImdChannel_list()"
                                (onSelectAll)="get_subImdChannel_list()"
                                (onDeSelect)="get_subImdChannel_list()"
                                (onDeSelectAll)="get_subImdChannel_list()"
                                >
                            </ng-multiselect-dropdown>
                        </div> -->

                        <!-- <div class="multiselectFilter">
                            <span  class="filterLabel" >Sub Imd Channel</span>
                            <ng-multiselect-dropdown
                                [placeholder]="'SUBIMD CHANNEL'"
                                [settings]="subImdChannel_dropdownSettings"
                                [data]="subImdChannel_dropdownList"
                                [(ngModel)]="subImdChannel_selectedItems"
                                >
                            </ng-multiselect-dropdown>
                        </div> -->

                        <div class="multiselectFilter" *ngIf="aopChecked == false">
                            <!-- <span class="filterLabel" >SUB CHANNEL NAME</span> -->
                            <ng-multiselect-dropdown
                                [placeholder]="'SUB CHANNEL NAME'"
                                [settings]="subChannelCodeName_dropdownSettings"
                                [data]="subChannelCodeName_dropdownList"
                                [(ngModel)]="subChannelCodeName_selectedItems"
                                (onSelect)="get_imdCodeName_list();"
                                (onSelectAll)="get_imdCodeName_list();"
                                (onDeSelect)="get_imdCodeName_list();"
                                (onDeSelectAll)="get_imdCodeName_list();"
                                >
                            </ng-multiselect-dropdown>
                        </div>
                        <div class="multiselectFilter">
                            <!-- <span  class="filterLabel" >P ACC LOB</span> -->
                            <ng-multiselect-dropdown
                                [placeholder]="'P ACC LOB'"
                                [settings]="pAccLob_dropdownSettings"
                                [data]="pAccLob_dropdownList"
                                [(ngModel)]="pAccLob_selectedItems" 
                                (onSelect)="get_productCodeName_list()"
                                (onSelectAll)="get_productCodeName_list()"
                                (onDeSelect)="get_productCodeName_list()"
                                (onDeSelectAll)="get_productCodeName_list()"
                                >
                            </ng-multiselect-dropdown>
                        </div>

                        <div class="multiselectFilter" *ngIf="aopChecked == false">
                            <!-- <span class="filterLabel" >PRODUCT CODE</span> -->
                            <ng-multiselect-dropdown
                                [placeholder]="'PRODUCT CODE'"
                                [settings]="productCodeName_dropdownSettings"
                                [data]="productCodeName_dropdownList"
                                [(ngModel)]="productCodeName_selectedItems"
                                >
                            </ng-multiselect-dropdown>
                        </div>

                        <div class="multiselectFilter" *ngIf="aopChecked == false">
                            <!-- <span class="filterLabel" >PRODUCT CODE BS</span> -->
                            <ng-multiselect-dropdown
                                [placeholder]="'PRODUCT CODE BS'"
                                [settings]="productCodeNameBS_dropdownSettings"
                                [data]="productCodeNameBS_dropdownList"
                                [(ngModel)]="productCodeNameBS_selectedItems"
                                >
                            </ng-multiselect-dropdown>
                        </div>
                        <div class="multiselectFilter" *ngIf="aopChecked == false">
                            <!-- <span class="filterLabel" >NET PREMIUM SLAB</span> -->
                            <ng-multiselect-dropdown
                                [placeholder]="'NET PREMIUM SLAB'"
                                [settings]="netPremiumSlab_dropdownSettings"
                                [data]="netPremiumSlab_dropdownList"
                                [(ngModel)]="netPremiumSlab_selectedItems"
                                >
                            </ng-multiselect-dropdown>
                        </div>

                        <div class="multiselectFilter" *ngIf="aopChecked == false">
                            <!-- <span class="filterLabel" >ZONE</span> -->
                            <ng-multiselect-dropdown
                                [placeholder]="'ZONE'"
                                [settings]="zone_dropdownSettings"
                                [data]="zone_dropdownList"
                                [(ngModel)]="zone_selectedItems"
                                (onSelect)="get_state_list(); get_location_list()"
                                (onSelectAll)="get_state_list(); get_location_list()"
                                (onDeSelect)="get_state_list(); get_location_list()"
                                (onDeSelectAll)="get_state_list(); get_location_list()"
                                >
                            </ng-multiselect-dropdown>
                        </div>

                        <div class="multiselectFilter" *ngIf="aopChecked == false">
                            <!-- <span class="filterLabel" >STATE</span> -->
                            <ng-multiselect-dropdown
                                [placeholder]="'STATE'"
                                [settings]="state_dropdownSettings"
                                [data]="state_dropdownList"
                                [(ngModel)]="state_selectedItems"
                                (onSelect)="get_location_list()"
                                (onSelectAll)="get_location_list()"
                                (onDeSelect)="get_location_list()"
                                (onDeSelectAll)="get_location_list()"
                                >
                            </ng-multiselect-dropdown>
                        </div>

                        <div class="multiselectFilter" *ngIf="aopChecked == false">
                            <!-- <span class="filterLabel" >LOCATION</span> -->
                            <ng-multiselect-dropdown
                                [placeholder]="'LOCATION'"
                                [settings]="location_dropdownSettings"
                                [data]="location_dropdownList"
                                [(ngModel)]="location_selectedItems"
                                >
                            </ng-multiselect-dropdown>
                        </div>

                                              

                        <div class="multiselectFilter imdfilter" *ngIf="aopChecked == false">
                            <!-- <span class="filterLabel" >IMD CODE(Single)</span> -->
                            <div class="row">
                                <!-- <form > -->
                                  <input   type="text" placeholder="IMD CODE(Single)" name="search" [(ngModel)]="imdCode_search" value="imdCode_search" (keyup.enter)="get_imdCodeName_list();showDropdownImd = 1;">
                                  <!-- <button type="submit">Submit</button> -->
                                  <mat-icon class="search" (click)="get_imdCodeName_list();showDropdownImd = 1;">search</mat-icon>
                                  <!-- <mat-icon class="search" (click)="get_imdCodeName_list();showDropdownImd = 1;">search</mat-icon> -->


                                  <mat-icon class="dropdown_icon" *ngIf="showDropdownImd == 0" (click)="showDropdownImd = 1">arrow_drop_down</mat-icon>
                                  <mat-icon class="dropdown_icon" *ngIf="showDropdownImd == 1" (click)="showDropdownImd = 0">arrow_drop_up</mat-icon>

                                <!-- </form> -->

                                
                            </div>
                            <div class="row" *ngIf="showDropdownImd == 1" style="height:110px; overflow-y: scroll;">
                                
                                <ul style="padding-left: 3px !important;padding-top: 6px !important;">

                                    <ng-container *ngFor="let imd of imdCodeName_dropdownList">
                                        <li style=" font-size: 11pt;"> <input type="checkbox"  [checked]="(imd.checked) && (imd_code == imd.codeImd)" [(ngModel)]="imd.checked" (change)="checkImd( imd.codeImd, imd.checked);  get_subImdCodeName_list();" >
                                            &nbsp;
                                            <!-- &nbsp; -->
                                            <!-- <span style="color:white">
                                                {{imd.checked}} {{imd_code}}</span> -->
                                        <span style="color:white">{{imd.codeImd}}</span></li>
                                </ng-container>
                                </ul>
                            </div>
                              
                            <!-- <ng-multiselect-dropdown
                                [placeholder]="''"
                                [settings]="imdCodeName_dropdownSettings"
                                [data]="imdCodeName_dropdownList"
                                [(ngModel)]="imdCodeName_selectedItems"
                                
                                (onSelect)="get_subImdCodeName_list()"
                                (onSelectAll)="get_subImdCodeName_list()"
                                (onDeSelect)="get_subImdCodeName_list()"
                                (onDeSelectAll)="get_subImdCodeName_list()"
                                >
                            </ng-multiselect-dropdown> -->
                        </div>

                        
                        <div class="multiselectFilter" *ngIf="aopChecked == false">
                            <!-- <span class="filterLabel" >SUB IMD CODE(Single)</span> -->
                            <div class="row">
                                <!-- <form > -->
                                  <input  type="text" placeholder="SUB IMD CODE(Single)" name="search" [(ngModel)]="subImdCode_search" value="subImdCode_search" (keyup.enter)="get_subImdCodeName_list();showDropdownSubImd = 1" >
                                  <!-- <button type="submit">Submit</button> -->
                                  <mat-icon class="search" (click)="get_subImdCodeName_list();showDropdownSubImd = 1">search</mat-icon>

                                  <mat-icon class="dropdown_icon" *ngIf="showDropdownSubImd == 0" (click)="showDropdownSubImd = 1">arrow_drop_down</mat-icon>
                                  <mat-icon class="dropdown_icon" *ngIf="showDropdownSubImd == 1" (click)="showDropdownSubImd = 0">arrow_drop_up</mat-icon>
                                <!-- </form> -->
                              </div>
                            <!-- <ng-multiselect-dropdown
                                [placeholder]="'SUBIMD CODE'"
                                [settings]="subImdCodeName_dropdownSettings"
                                [data]="subImdCodeName_dropdownList"
                                [(ngModel)]="subImdCodeName_selectedItems"
                                >
                            </ng-multiselect-dropdown> -->

                            <div class="row" *ngIf="showDropdownSubImd == 1" style="height:110px; overflow-y: scroll;">
                                
                                <ul style="padding-left: 3px !important;padding-top: 6px !important;">

                                    <ng-container *ngFor="let subimd of subImdCodeName_dropdownList">
                                        <li style=" font-size: 11pt;"> <input type="checkbox"  [checked]="(subimd.checked) && (imd_code == subimd.subImdCode)" [(ngModel)]="subimd.checked" (change)="checkSubImd( subimd.subImdCode, subimd.checked)" >
                                            &nbsp;
                                            <!-- &nbsp; -->
                                            <!-- <span style="color:white">
                                                {{imd.checked}} {{imd_code}}</span> -->
                                        <span style="color:white">{{subimd.subImdCode}}</span></li>
                                </ng-container>
                                </ul>
                            </div>


                        </div>

                        <!-- <br> -->
                       


                        <div class="multiselectFilter" style="margin-left: 5%;" *ngIf="aopChecked == false">
                            <div *ngIf="imdInfo == 1" class="infoBox" >
                                <mat-icon class="close_icon" (click)="imdInfo = 0">close</mat-icon>
                                <div class="row" style="padding:5% !important">

                                    <!-- Keep all IMDs in the first column of a CSV file(.csv) without any header/column name. -->
                                    Only CSV Files are accepted. Please remove all column names.
                                </div>
                                </div>
                            <span class="filterLabel" >IMD CODE(Multiple)  <mat-icon style="font-size: 12pt; cursor:pointer" (click)="imdInfo = 1" >info</mat-icon></span>
                            
                            <input accept=" .csv" type="file" #file id="fileUpImd" [multiple]="false" (change)="saveFileImd($event)"/>

                            

                        </div>

                        <div class="multiselectFilter" style="margin-left: 5%;" *ngIf="aopChecked == false">
                            <!-- <span class="filterLabel" >SUB IMD CODE(Multiple)</span>
                            <input accept=" .csv" type="file" #file id="fileUpSubImd" [multiple]="false" (change)="saveFileSubImd($event)"/> -->


                            <div *ngIf="subImdInfo == 1" class="infoBox" >
                                <mat-icon class="close_icon" (click)="subImdInfo = 0">close</mat-icon>
                                <div class="row" style="padding:5% !important">

                                    <!-- Keep all SUB IMDs in the first column of a CSV file(.csv) without any header/column name. -->
                                    Only CSV Files are accepted. Please remove all column names.
                                </div>
                                </div>
                            <span class="filterLabel" >SUB IMD CODE(Multiple)  <mat-icon style="font-size: 12pt; cursor:pointer" (click)="subImdInfo = 1" >info</mat-icon></span>
                            
                            <input accept=" .csv" type="file" #file id="fileUpSubImd" [multiple]="false" (change)="saveFileSubImd($event)"/>
                           
                        </div>

                          
                       


                        

                        <br>
                        



                        <br><br><br><br><br><br><br><br><br>

                        

                    </div>
                    

                    <!-- <div class="col-12 mainMenu" style="background-color: #053b5a!important; color: #ffffff; padding:15px;padding-bottom: 10px!important; padding-top: 0;">

                        <ng-multiselect-dropdown
                            [placeholder]="'Business Category'"
                            [settings]="dropdownSettings"
                            [data]="dropdownList"
                            [(ngModel)]="selectedItems"
                            (onSelect)="onItemSelect($event)"
                            (onSelectAll)="onSelectAll($event)" 
                            >
                        </ng-multiselect-dropdown>
                        


                    </div> -->
                    
            </div>

            <div class="row" style="position: fixed; left:0; bottom:0; width:250px; ">
                <div class="col-6" style="padding:0">
                    <button  class="filterApplyButton" style=" background-color: rgb(238, 99, 99);" (click)="resetAll()">
                        <span>Reset All</span>
                    </button>
                    
                </div>

                <div class="col-6" style="padding:0">
                    <button  class="filterApplyButton" [disabled]="blockFilter"  (click)="
                    callFilterResult('summary',0, 0);
                     callFilterResult('details', 0, 0)">
                    <!-- <button  class="filterApplyButton"   (click)=" callFilterResult('details', 0, 0)">                     -->
                        <span>Filter</span>
                    </button>
                    
                </div>
            </div>
        </div>




















        <div class="mainArea"  [ngClass]="(sideNavOpen == false)?'mainArea_max':''">

            <button class="toogleSidenav" (click)="sideNavOpen = !sideNavOpen"  [ngClass]="(sideNavOpen == false)?'toogleSidenav_close':''">
                <i *ngIf="sideNavOpen" class="fa fa-arrow-left"></i>
                <i *ngIf="!sideNavOpen" class="fa fa-arrow-right"></i>
            </button>

            <div class="row mainAreaPad">                

                <div class="col-12">

                    <div *ngIf="reportStatus" class="row reportTimePad" id="reportTimePad">
                        <div class="col-11">
                            <p>Report Start Time: {{reportStart}} || Report End Time: {{reportEnd}} || Total Duration: {{reportDuration}}</p>
                        </div>
                        <div class="col-1 text-right">
                            <p style="font-size: 13px; font-weight: bold; cursor: pointer;" (click)="reportStatus=false;reportCrossStatus = true">X</p>
                        </div>
                    </div>
                    <!-- <div *ngIf="reportCrossStatus" class="row reportTimePadCross">
                        <div class="col-11">
                            <p>Report Start Time: {{reportStart}} || Report End Time: {{reportEnd}} || Total Duration: {{reportDuration}}</p>
                        </div>
                        <div class="col-1 text-right">
                            <p style="font-size: 13px; font-weight: bold; cursor: pointer;" (click)="reportStatus=false">X</p>
                        </div>
                    </div> -->

                    <div class="row reportNamePad">
                        <div class="col-6">
                            <p class="reportName">Summary Report</p>
                        </div>
                        <div class="col-6" style="display: flex; justify-content: right;">
                            <!-- {{aopChecked}} -->


                            <span *ngIf="!noShowAopList.includes(userEmail)" style="font-weight: bold; font-size: 11pt;">Show with AOP &nbsp;</span>
                            <label  *ngIf="!noShowAopList.includes(userEmail)"  class="switch">
                                
                                <input class="aopchcking" type="checkbox" [(ngModel)]="aopChecked" (change)="callFilterResult('summary',0, 0);
                     callFilterResult('details', 0, 0)">
                                <span class="slider round"></span>
                              </label>

                              &nbsp;


                            <button class="downloadButton" (click)="callFilterResult('summary', 1, 0)">
                                <mat-icon>cloud_download</mat-icon>
                            </button>
                        </div>
                        
                    </div>
                    <!-- <br> -->

                    <div class="reportArea mt-1">
                        <table *ngIf="monthOnMonthFlag == 0" class="table table-hover">

                            <thead>
                                <tr>
                                    <th style="padding: 0 !important;" [attr.colspan]="summary_keyColcount" *ngIf="summary_keyColcount!=0"  class="columnColor"></th>
                                    <th style="padding: 0 !important;" *ngIf="aopChecked == false" colspan="11" class="columnColor">PREM in Crs</th>

                                    <th style="padding: 0 !important;" *ngIf="aopChecked == true" colspan="15" class="columnColor">PREM in Crs</th>

                                    <th style="padding: 0 !important;" colspan="11" class="columnColor">NOP</th>
                                    <!-- <th style="padding: 0 !important;" colspan="13" *ngIf="aopChecked == true" class="columnColor">NOP</th> -->

                                </tr>
                                
                            </thead>
                            <thead>
                                <tr>
                                    <th style="padding: 0 !important;" [attr.colspan]="summary_keyColcount" *ngIf="summary_keyColcount!=0"  class="columnColor"></th>
                                    <th style="padding: 0 !important;" colspan="4" *ngIf="aopChecked == false"  class="columnColor">YTD</th>
                                    <th style="padding: 0 !important;" colspan="6" *ngIf="aopChecked == true"  class="columnColor">YTD</th>

                                    <th style="padding: 0 !important;" colspan="7"  *ngIf="aopChecked == false" class="columnColor">MTD</th>
                                    <th style="padding: 0 !important;" colspan="9"  *ngIf="aopChecked == true" class="columnColor">MTD</th>

                                    <th style="padding: 0 !important;" colspan="4"  class="columnColor">YTD</th>
                                    <th style="padding: 0 !important;" colspan="7"  class="columnColor">MTD</th>
                                </tr>
                                
                            </thead>

                            <thead>
                              <tr>
                                <ng-container *ngFor="let col of summary_mainColList">
                                    <th class="columnColor">{{col}}</th>
                                </ng-container>
    
    
    
    
                                <th scope="col"  class="columnColor">YTD PREM</th>
                                <th scope="col"  class="columnColor">LYTD PREM</th>
                                <th scope="col"  class="columnColor">% GROWTH</th>
                                <th scope="col"  class="columnColor">Trend</th>
                                <th scope="col"  class="columnColor" *ngIf="aopChecked == true">AOP</th>
                                <th scope="col"  class="columnColor" *ngIf="aopChecked == true">% Ach</th>


    
                                <th scope="col"  class="columnColor">MTD PREM</th>
                                <th scope="col"  class="columnColor">LYMTD PREM</th>
                                <th scope="col"  class="columnColor">% GROWTH</th>
                                <th scope="col"  class="columnColor">Trend</th>
                                <th scope="col"  class="columnColor">CYLMTD PREM</th>
                                <th scope="col"  class="columnColor">% GROWTH</th>
                                <th scope="col"  class="columnColor">Trend</th>
                                <th scope="col"  class="columnColor" *ngIf="aopChecked == true">AOP</th>
                                <th scope="col"  class="columnColor" *ngIf="aopChecked == true">% Ach</th>


    
                                <th scope="col"  class="columnColor">YTD NOP</th>
                                <th scope="col"  class="columnColor">LYTD NOP</th>
                                <th scope="col"  class="columnColor">% GROWTH</th>
                                <th scope="col"  class="columnColor">Trend</th>
    
                                <th scope="col"  class="columnColor">MTD NOP</th>
                                <th scope="col"  class="columnColor">LYMTD NOP</th>
                                <th scope="col"  class="columnColor">% GROWTH</th>
                                <th scope="col"  class="columnColor">Trend</th>
    
                                <th scope="col"  class="columnColor">CYLMTD NOP</th>
                                <th scope="col"  class="columnColor">% GROWTH</th>
                                <th scope="col"  class="columnColor">Trend</th>
                                
                                
                              </tr>
                            </thead>
                            <tbody>
                                <ng-container *ngFor="let rowline of summary_filteredResult" >

                                    <tr [ngClass]="(rowline.BUSINESS_CATEGORY == 'Customer Loyalty Total')?'rowColor_CLtotal':''">

                                        <ng-container *ngFor="let col of summary_mainColList">
                                            <td class="tableColumnStyle">{{rowline[col]}}</td>
                                        </ng-container>
            
            
                                        
                                       <td class="tableColumnStyle">{{rowline.YTD_PREMIUM}}</td>
                                       <td class="tableColumnStyle">{{rowline.LYTD_PREMIUM}}</td>
                                       <td class="tableColumnStyle" [ngClass]="(rowline.YTD_PREM_GROWTH_PERC >= 0)?'growth':'degrowth'" >{{rowline.YTD_PREM_GROWTH_PERC}}%</td>
                                       <td *ngIf="rowline.YTD_PREM_TREND == 'Raise'" style="color: rgb(0, 170, 0)" class="tableColumnStyle">{{rowline.YTD_PREM_TREND}}</td>
                                       <td *ngIf="rowline.YTD_PREM_TREND == 'Down'" style="color: rgb(255, 0, 0)" class="tableColumnStyle">{{rowline.YTD_PREM_TREND}}</td>
                                       <td *ngIf="rowline.YTD_PREM_TREND == 'Same'" class="tableColumnStyle">{{rowline.YTD_PREM_TREND}}</td>

                                       <td class="tableColumnStyle" *ngIf="aopChecked == true">{{rowline.YTD_AOP}}</td>
                                       <td class="tableColumnStyle" *ngIf="aopChecked == true" [ngClass]="(rowline.YTD_ACH_PERC >= 100)? 'up':'down'">{{rowline.YTD_ACH_PERC}}%</td>

                                       <!-- <td class="tableColumnStyle">{{rowline.MTD_PREMIUM}}</td> -->

                                       
        
                                       <td class="tableColumnStyle">{{rowline.MTD_PREMIUM}}</td>
                                       <td class="tableColumnStyle">{{rowline.LYMTD_PREMIUM}}</td>
                                       <td class="tableColumnStyle" [ngClass]="(rowline.LYMTD_PREM_GROWTH_PERC >= 0)?'growth':'degrowth'" >{{rowline.LYMTD_PREM_GROWTH_PERC}}%</td>
                                       
                                       <td *ngIf="rowline.LYMTD_PREM_TREND == 'Raise'" style="color: rgb(0, 170, 0)" class="tableColumnStyle">{{rowline.LYMTD_PREM_TREND}}</td>
                                       <td *ngIf="rowline.LYMTD_PREM_TREND == 'Down'" style="color: rgb(255, 0, 0)" class="tableColumnStyle">{{rowline.LYMTD_PREM_TREND}}</td>
                                       <td *ngIf="rowline.LYMTD_PREM_TREND == 'Same'" class="tableColumnStyle">{{rowline.LYMTD_PREM_TREND}}</td>


                                       <td class="tableColumnStyle">{{rowline.CYLMTD_PREMIUM}}</td>
                                       <td class="tableColumnStyle" [ngClass]="(rowline.CYLMTD_PREM_GROWTH_PERC >= 0)?'growth':'degrowth'" >{{rowline.CYLMTD_PREM_GROWTH_PERC}}%</td>
                                    
                                       <td *ngIf="rowline.CYLMTD_PREM_TREND == 'Raise'" style="color: rgb(0, 170, 0)" class="tableColumnStyle">{{rowline.CYLMTD_PREM_TREND}}</td>
                                       <td *ngIf="rowline.CYLMTD_PREM_TREND == 'Down'" style="color: rgb(255, 0, 0)" class="tableColumnStyle">{{rowline.CYLMTD_PREM_TREND}}</td>
                                       <td *ngIf="rowline.CYLMTD_PREM_TREND == 'Same'" class="tableColumnStyle">{{rowline.CYLMTD_PREM_TREND}}</td>

                                       <td class="tableColumnStyle" *ngIf="aopChecked == true">{{rowline.MTD_AOP}}</td>
                                       <td class="tableColumnStyle" *ngIf="aopChecked == true" [ngClass]="(rowline.MTD_ACH_PERC >= 100)? 'up':'down'">{{rowline.MTD_ACH_PERC}}%</td>
        
                                       <td class="tableColumnStyle">{{rowline.YTD_NOP}}</td>
                                       <td class="tableColumnStyle">{{rowline.LYTD_NOP}}</td>
                                       <td class="tableColumnStyle" [ngClass]="(rowline.YTD_NOP_GROWTH_PERC >= 0)?'growth':'degrowth'" >{{rowline.YTD_NOP_GROWTH_PERC}}%</td>
                                     
                                       <td *ngIf="rowline.YTD_NOP_TREND == 'Raise'" style="color: rgb(0, 170, 0)" class="tableColumnStyle">{{rowline.YTD_NOP_TREND}}</td>
                                       <td *ngIf="rowline.YTD_NOP_TREND == 'Down'" style="color: rgb(255, 0, 0)" class="tableColumnStyle">{{rowline.YTD_NOP_TREND}}</td>
                                       <td *ngIf="rowline.YTD_NOP_TREND == 'Same'" class="tableColumnStyle">{{rowline.YTD_NOP_TREND}}</td>
        
                                       <td class="tableColumnStyle">{{rowline.MTD_NOP}}</td>
                                       <td class="tableColumnStyle">{{rowline.LYMTD_NOP}}</td>
                                       <td class="tableColumnStyle" [ngClass]="(rowline.LYMTD_NOP_GROWTH_PERC >= 0)?'growth':'degrowth'" >{{rowline.LYMTD_NOP_GROWTH_PERC}}%</td>
                                       
                                       <td *ngIf="rowline.LYMTD_NOP_TREND == 'Raise'" style="color: rgb(0, 170, 0)" class="tableColumnStyle">{{rowline.LYMTD_NOP_TREND}}</td>
                                       <td *ngIf="rowline.LYMTD_NOP_TREND == 'Down'" style="color: rgb(255, 0, 0)" class="tableColumnStyle">{{rowline.LYMTD_NOP_TREND}}</td>
                                       <td *ngIf="rowline.LYMTD_NOP_TREND == 'Same'" class="tableColumnStyle">{{rowline.LYMTD_NOP_TREND}}</td>
        
                                       <td class="tableColumnStyle">{{rowline.CYLMTD_NOP}}</td>
                                       <td class="tableColumnStyle" [ngClass]="(rowline.CYLMTD_NOP_GROWTH_PERC >= 0)?'growth':'degrowth'" >{{rowline.CYLMTD_NOP_GROWTH_PERC}}%</td>
                                     
                                       <td *ngIf="rowline.CYLMTD_NOP_TREND == 'Raise'" style="color: rgb(0, 170, 0)" class="tableColumnStyle">{{rowline.CYLMTD_NOP_TREND}}</td>
                                       <td *ngIf="rowline.CYLMTD_NOP_TREND == 'Down'" style="color: rgb(255, 0, 0)" class="tableColumnStyle">{{rowline.CYLMTD_NOP_TREND}}</td>
                                       <td *ngIf="rowline.CYLMTD_NOP_TREND == 'Same'" class="tableColumnStyle">{{rowline.CYLMTD_NOP_TREND}}</td>
                                        
                                    </tr>  

                                </ng-container>                  
                              
                            </tbody>
                          </table>


                          <table *ngIf="monthOnMonthFlag == 1" class="table table-hover">

                            <thead>
                                <tr>
                                    <th style="padding: 0 !important;" [attr.colspan]="summary_keyColcount" *ngIf="summary_keyColcount!=0"  class="columnColor"></th>
                                    <!-- <th colspan="11" class="columnColor">PREM in Crs</th>
                                    <th colspan="11" class="columnColor">NOP</th> -->

                                    <ng-container *ngFor="let eachMonth of monthYearList">
                                        <th class="columnColor" style="padding: 0 !important;" colSpan="4">{{eachMonth}}</th>
                                    </ng-container>
                                </tr>
                                
                            </thead>
                            <!-- <thead>
                                <tr>
                                    <th style="padding: 0 !important;" [attr.colspan]="summary_keyColcount" *ngIf="summary_keyColcount!=0"  class="columnColor"></th>

                                    <ng-container *ngFor="let eachMonth of monthYearList">
                                        <th style="padding: 0 !important;" class="columnColor" colSpan="2">NOP</th>
                                        <th style="padding: 0 !important;" class="columnColor" colSpan="2">PREMIUM</th>

                                    </ng-container>
                                    
                                </tr>
                                
                            </thead> -->

                            <thead>
                              <tr>
                                <ng-container *ngFor="let col of summary_mainColList">
                                    <th class="columnColor">{{col}}</th>
                                </ng-container>

                                <ng-container *ngFor="let eachMonth of monthYearList">
                                    <th class="columnColor" >NOP</th>
                                    <th class="columnColor" >LYFTM GROWTH</th>

                                    <th class="columnColor" >PREMIUM</th>
                                    <th class="columnColor" >LYFTM GROWTH</th>

                                </ng-container>
    
    
    
    
                                <!-- <th scope="col"  class="columnColor">YTD PREM</th>
                                <th scope="col"  class="columnColor">LYTD PREM</th>
                                <th scope="col"  class="columnColor">% GROWTH</th>
                                <th scope="col"  class="columnColor">Trend</th>
    
                                <th scope="col"  class="columnColor">MTD PREM</th>
                                <th scope="col"  class="columnColor">LYMTD PREM</th>
                                <th scope="col"  class="columnColor">% GROWTH</th>
                                <th scope="col"  class="columnColor">Trend</th>
                                <th scope="col"  class="columnColor">CYLMTD PREM</th>
                                <th scope="col"  class="columnColor">% GROWTH</th>
                                <th scope="col"  class="columnColor">Trend</th>
    
                                <th scope="col"  class="columnColor">YTD NOP</th>
                                <th scope="col"  class="columnColor">LYTD NOP</th>
                                <th scope="col"  class="columnColor">% GROWTH</th>
                                <th scope="col"  class="columnColor">Trend</th>
    
                                <th scope="col"  class="columnColor">MTD NOP</th>
                                <th scope="col"  class="columnColor">LYMTD NOP</th>
                                <th scope="col"  class="columnColor">% GROWTH</th>
                                <th scope="col"  class="columnColor">Trend</th>
    
                                <th scope="col"  class="columnColor">CYLMTD NOP</th>
                                <th scope="col"  class="columnColor">% GROWTH</th>
                                <th scope="col"  class="columnColor">Trend</th>
                                 -->
                                
                              </tr>
                            </thead>
                            <tbody>
                                <ng-container *ngFor="let rowline of summary_filteredResult" >

                                    <tr [ngClass]="(rowline.BUSINESS_CATEGORY == 'Customer Loyalty Total')?'rowColor_CLtotal':''">

                                        <ng-container *ngFor="let col of summary_mainColList">
                                            <td class="tableColumnStyle">{{rowline[col]}}</td>
                                        </ng-container>

                                        <ng-container *ngFor="let eachMonth of monthYearList">
                                            <td class="tableColumnStyle">{{rowline[eachMonth + '_NOP']}}</td>
                                            <td class="tableColumnStyle" [ngClass]="(rowline[eachMonth + '_NOP_LYFTM_GROWTH'] >= 0)?'growth':'degrowth'" >{{rowline[eachMonth + '_NOP_LYFTM_GROWTH']}}%</td>
                                            <td class="tableColumnStyle">{{rowline[eachMonth + '_PREM']}}</td>
                                            <td class="tableColumnStyle" [ngClass]="(rowline[eachMonth + '_PREM_LYFTM_GROWTH'] >= 0)?'growth':'degrowth'">{{rowline[eachMonth + '_PREM_LYFTM_GROWTH']}}%</td>


        
                                        </ng-container>
            
            
                                        
                                       
                                        
                                    </tr>  

                                </ng-container>                  
                              
                            </tbody>
                          </table>
                    </div>



                    <!-- <br><br><br> -->



                    <div class="row reportNamePad" style="margin-top: 20px!important;">
                        <!-- <p class="reportName">Detail Report</p> -->
                        <div class="col-6">
                            <p class="reportName">Detail Report</p>
                        </div>
                        <div class="col-6" style="display: flex; justify-content: right;">
                            <button class="downloadButton" (click)="callFilterResult('details', 1, 0)">
                                <mat-icon>cloud_download</mat-icon>
                            </button>
                        </div>
                    </div>
                    <!-- <br> -->

                    <div class="reportArea mt-1">
                        <table *ngIf="monthOnMonthFlag == 0" class="table table-hover">

                            <thead>
                                <tr>
                                    <th style="padding: 0 !important;" [attr.colspan]="details_keyColcount" *ngIf="details_keyColcount!=0" class="columnColor"></th>
                                    <!-- <th style="padding: 0 !important;" colspan="11" class="columnColor">PREM in Crs</th> -->
                                    <th style="padding: 0 !important;" *ngIf="aopChecked == false" colspan="11" class="columnColor">PREM in Crs</th>

                                    <th style="padding: 0 !important;" *ngIf="aopChecked == true" colspan="15" class="columnColor">PREM in Crs</th>

                                    <th style="padding: 0 !important;" colspan="11" class="columnColor">NOP</th>
                                </tr>
                                
                            </thead>
                            <thead>
                                <tr>
                                    <th style="padding: 0 !important;" [attr.colspan]="details_keyColcount" *ngIf="details_keyColcount!=0"  class="columnColor"></th>
                                    <th style="padding: 0 !important;" colspan="4" *ngIf="aopChecked == false"  class="columnColor">YTD</th>
                                    <th style="padding: 0 !important;" colspan="6" *ngIf="aopChecked == true"  class="columnColor">YTD</th>

                                    <th style="padding: 0 !important;" colspan="7"  *ngIf="aopChecked == false" class="columnColor">MTD</th>
                                    <th style="padding: 0 !important;" colspan="9"  *ngIf="aopChecked == true" class="columnColor">MTD</th>
                                    <!-- <th style="padding: 0 !important;" colspan="4"  class="columnColor">YTD</th>
                                    <th style="padding: 0 !important;" colspan="7"  class="columnColor">MTD</th> -->
                                    <th style="padding: 0 !important;" colspan="4"  class="columnColor">YTD</th>
                                    <th style="padding: 0 !important;" colspan="7"  class="columnColor">MTD</th>
                                </tr>
                                
                            </thead>

                            <thead>
                              <tr>
                                <ng-container *ngFor="let col of details_mainColList">
                                    <th class="columnColor">{{col}}</th>
                                </ng-container>
    
    
    
    
                                <th scope="col"  class="columnColor">YTD PREM</th>
                                <th scope="col"  class="columnColor">LYTD PREM</th>
                                <th scope="col"  class="columnColor">% GROWTH</th>
                                <th scope="col"  class="columnColor">Trend</th>
                                <th scope="col"  class="columnColor" *ngIf="aopChecked == true">AOP</th>
                                <th scope="col"  class="columnColor" *ngIf="aopChecked == true">% Ach</th>
                                <th scope="col"  class="columnColor">MTD PREM</th>
                                <th scope="col"  class="columnColor">LYMTD PREM</th>
                                <th scope="col"  class="columnColor">% GROWTH</th>
                                <th scope="col"  class="columnColor">Trend</th>
                                <th scope="col"  class="columnColor">CYLMTD PREM</th>
                                <th scope="col"  class="columnColor">% GROWTH</th>
                                <th scope="col"  class="columnColor">Trend</th>
                                <th scope="col"  class="columnColor" *ngIf="aopChecked == true">AOP</th>
                                <th scope="col"  class="columnColor" *ngIf="aopChecked == true">% Ach</th>

                                <th scope="col"  class="columnColor">YTD NOP</th>
                                <th scope="col"  class="columnColor">LYTD NOP</th>
                                <th scope="col"  class="columnColor">% GROWTH</th>
                                <th scope="col"  class="columnColor">Trend</th>
    
                                <th scope="col"  class="columnColor">MTD NOP</th>
                                <th scope="col"  class="columnColor">LYMTD NOP</th>
                                <th scope="col"  class="columnColor">% GROWTH</th>
                                <th scope="col"  class="columnColor">Trend</th>
    
                                <th scope="col"  class="columnColor">CYLMTD NOP</th>
                                <th scope="col"  class="columnColor">% GROWTH</th>
                                <th scope="col"  class="columnColor">Trend</th>
                                
                                
                              </tr>
                            </thead>
                            <tbody>
                                <ng-container *ngFor="let rowline of details_filteredResult" >

                                    <tr [ngClass]="(rowline.BUSINESS_CATEGORY == 'Customer Loyalty Total')?'rowColor_CLtotal':''">

                                        <ng-container *ngFor="let col of details_mainColList">
                                            <td class="tableColumnStyle">{{rowline[col]}}</td>
                                        </ng-container>



                                        <td class="tableColumnStyle">{{rowline.YTD_PREMIUM}}</td>
                                       <td class="tableColumnStyle">{{rowline.LYTD_PREMIUM}}</td>
                                       <td class="tableColumnStyle" [ngClass]="(rowline.YTD_PREM_GROWTH_PERC >= 0)?'growth':'degrowth'">{{rowline.YTD_PREM_GROWTH_PERC}}%</td>
                                       <td *ngIf="rowline.YTD_PREM_TREND == 'Raise'" style="color: rgb(0, 170, 0)" class="tableColumnStyle">{{rowline.YTD_PREM_TREND}}</td>
                                       <td *ngIf="rowline.YTD_PREM_TREND == 'Down'" style="color: rgb(255, 0, 0)" class="tableColumnStyle">{{rowline.YTD_PREM_TREND}}</td>
                                       <td *ngIf="rowline.YTD_PREM_TREND == 'Same'" class="tableColumnStyle">{{rowline.YTD_PREM_TREND}}</td>
                                       <td class="tableColumnStyle" *ngIf="aopChecked == true">{{rowline.YTD_AOP}}</td>
                                       <td class="tableColumnStyle" *ngIf="aopChecked == true" [ngClass]="(rowline.YTD_ACH_PERC >= 100)? 'up':'down'">{{rowline.YTD_ACH_PERC}}%</td>
        
                                       <td class="tableColumnStyle">{{rowline.MTD_PREMIUM}}</td>
                                       <td class="tableColumnStyle">{{rowline.LYMTD_PREMIUM}}</td>
                                       <td class="tableColumnStyle"[ngClass]="(rowline.LYMTD_PREM_GROWTH_PERC >= 0)?'growth':'degrowth'" >{{rowline.LYMTD_PREM_GROWTH_PERC}}%</td>
                                       <!-- <td class="tableColumnStyle">{{rowline.LYMTD_PREM_TREND}}</td> -->
                                       <td *ngIf="rowline.LYMTD_PREM_TREND == 'Raise'" style="color: rgb(0, 170, 0)" class="tableColumnStyle">{{rowline.LYMTD_PREM_TREND}}</td>
                                       <td *ngIf="rowline.LYMTD_PREM_TREND == 'Down'" style="color: rgb(255, 0, 0)" class="tableColumnStyle">{{rowline.LYMTD_PREM_TREND}}</td>
                                       <td *ngIf="rowline.LYMTD_PREM_TREND == 'Same'" class="tableColumnStyle">{{rowline.LYMTD_PREM_TREND}}</td>


                                       <td class="tableColumnStyle">{{rowline.CYLMTD_PREMIUM}}</td>
                                       <td class="tableColumnStyle" [ngClass]="(rowline.CYLMTD_PREM_GROWTH_PERC >= 0)?'growth':'degrowth'">{{rowline.CYLMTD_PREM_GROWTH_PERC}}%</td>
                                       <!-- <td class="tableColumnStyle">{{rowline.CYLMTD_PREM_TREND}}</td> -->
                                       <td *ngIf="rowline.CYLMTD_PREM_TREND == 'Raise'" style="color: rgb(0, 170, 0)" class="tableColumnStyle">{{rowline.CYLMTD_PREM_TREND}}</td>
                                       <td *ngIf="rowline.CYLMTD_PREM_TREND == 'Down'" style="color: rgb(255, 0, 0)" class="tableColumnStyle">{{rowline.CYLMTD_PREM_TREND}}</td>
                                       <td *ngIf="rowline.CYLMTD_PREM_TREND == 'Same'" class="tableColumnStyle">{{rowline.CYLMTD_PREM_TREND}}</td>
                                       <td class="tableColumnStyle" *ngIf="aopChecked == true">{{rowline.MTD_AOP}}</td>
                                       <td class="tableColumnStyle" *ngIf="aopChecked == true" [ngClass]="(rowline.MTD_ACH_PERC >= 100)? 'up':'down'">{{rowline.MTD_ACH_PERC}}%</td>

                                       <td class="tableColumnStyle">{{rowline.YTD_NOP}}</td>
                                       <td class="tableColumnStyle">{{rowline.LYTD_NOP}}</td>
                                       <td class="tableColumnStyle" [ngClass]="(rowline.YTD_NOP_GROWTH_PERC >= 0)?'growth':'degrowth'">{{rowline.YTD_NOP_GROWTH_PERC}}%</td>
                                       <!-- <td class="tableColumnStyle">{{rowline.YTD_NOP_TREND}}</td> -->
                                       <td *ngIf="rowline.YTD_NOP_TREND == 'Raise'" style="color: rgb(0, 170, 0)" class="tableColumnStyle">{{rowline.YTD_NOP_TREND}}</td>
                                       <td *ngIf="rowline.YTD_NOP_TREND == 'Down'" style="color: rgb(255, 0, 0)" class="tableColumnStyle">{{rowline.YTD_NOP_TREND}}</td>
                                       <td *ngIf="rowline.YTD_NOP_TREND == 'Same'" class="tableColumnStyle">{{rowline.YTD_NOP_TREND}}</td>
        
                                       <td class="tableColumnStyle">{{rowline.MTD_NOP}}</td>
                                       <td class="tableColumnStyle">{{rowline.LYMTD_NOP}}</td>
                                       <td class="tableColumnStyle" [ngClass]="(rowline.LYMTD_NOP_GROWTH_PERC >= 0)?'growth':'degrowth'">{{rowline.LYMTD_NOP_GROWTH_PERC}}%</td>
                                       <!-- <td class="tableColumnStyle">{{rowline.LYMTD_NOP_TREND}}</td> -->
                                       <td *ngIf="rowline.LYMTD_NOP_TREND == 'Raise'" style="color: rgb(0, 170, 0)" class="tableColumnStyle">{{rowline.LYMTD_NOP_TREND}}</td>
                                       <td *ngIf="rowline.LYMTD_NOP_TREND == 'Down'" style="color: rgb(255, 0, 0)" class="tableColumnStyle">{{rowline.LYMTD_NOP_TREND}}</td>
                                       <td *ngIf="rowline.LYMTD_NOP_TREND == 'Same'" class="tableColumnStyle">{{rowline.LYMTD_NOP_TREND}}</td>
        
                                       <td class="tableColumnStyle">{{rowline.CYLMTD_NOP}}</td>
                                       <td class="tableColumnStyle" [ngClass]="(rowline.CYLMTD_NOP_GROWTH_PERC >= 0)?'growth':'degrowth'">{{rowline.CYLMTD_NOP_GROWTH_PERC}}%</td>
                                       <!-- <td class="tableColumnStyle">{{rowline.CYLMTD_NOP_TREND}}</td> -->
                                       <td *ngIf="rowline.CYLMTD_NOP_TREND == 'Raise'" style="color: rgb(0, 170, 0)" class="tableColumnStyle">{{rowline.CYLMTD_NOP_TREND}}</td>
                                       <td *ngIf="rowline.CYLMTD_NOP_TREND == 'Down'" style="color: rgb(255, 0, 0)" class="tableColumnStyle">{{rowline.CYLMTD_NOP_TREND}}</td>
                                       <td *ngIf="rowline.CYLMTD_NOP_TREND == 'Same'" class="tableColumnStyle">{{rowline.CYLMTD_NOP_TREND}}</td>
            
            
                                        
                                       <!-- <td class="tableColumnStyle">{{rowline.YTD_PREMIUM}}</td>
                                       <td class="tableColumnStyle">{{rowline.LYTD_PREMIUM}}</td>
                                       <td class="tableColumnStyle">{{rowline.YTD_PREM_GROWTH_PERC}}</td>
                                       <td class="tableColumnStyle">{{rowline.YTD_PREM_TREND}}</td>
        
                                       <td class="tableColumnStyle">{{rowline.MTD_PREMIUM}}</td>
                                       <td class="tableColumnStyle">{{rowline.LYMTD_PREMIUM}}</td>
                                       <td class="tableColumnStyle">{{rowline.LYMTD_PREM_GROWTH_PERC}}</td>
                                       <td class="tableColumnStyle">{{rowline.LYMTD_PREM_TREND}}</td>
                                       <td class="tableColumnStyle">{{rowline.CYLMTD_PREMIUM}}</td>
                                       <td class="tableColumnStyle">{{rowline.CYLMTD_PREM_GROWTH_PERC}}</td>
                                       <td class="tableColumnStyle">{{rowline.CYLMTD_PREM_TREND}}</td>
        
                                       <td class="tableColumnStyle">{{rowline.YTD_NOP}}</td>
                                       <td class="tableColumnStyle">{{rowline.LYTD_NOP}}</td>
                                       <td class="tableColumnStyle">{{rowline.YTD_NOP_GROWTH_PERC}}</td>
                                       <td class="tableColumnStyle">{{rowline.LYMTD_NOP_TREND}}</td>
        
                                       <td class="tableColumnStyle">{{rowline.MTD_NOP}}</td>
                                       <td class="tableColumnStyle">{{rowline.LYMTD_NOP}}</td>
                                       <td class="tableColumnStyle">{{rowline.LYMTD_NOP_GROWTH_PERC}}</td>
                                       <td class="tableColumnStyle">{{rowline.LYMTD_NOP_TREND}}</td>
        
                                       <td class="tableColumnStyle">{{rowline.CYLMTD_NOP}}</td>
                                       <td class="tableColumnStyle">{{rowline.CYLMTD_NOP_GROWTH_PERC}}</td>
                                       <td class="tableColumnStyle">{{rowline.CYLMTD_NOP_TREND}}</td> -->
                                        
                                      </tr>  

                                </ng-container>                  
                              
                            </tbody>
                          </table>

                          <table *ngIf="monthOnMonthFlag == 1" class="table table-hover">

                            <thead>
                                <tr>
                                    <th style="padding: 0 !important;" [attr.colspan]="details_keyColcount" *ngIf="details_keyColcount!=0" class="columnColor"></th>
                                    <ng-container *ngFor="let eachMonth of monthYearList">
                                        <th style="padding: 0 !important;" class="columnColor" colSpan="4">{{eachMonth}}</th>
                                    </ng-container>
                                    <!-- <th colspan="11" class="columnColor">PREM in Crs</th>
                                    <th colspan="11" class="columnColor">NOP</th> -->
                                </tr>
                                
                            </thead>
                            <!-- <thead>
                                <tr>
                                    <th style="padding: 0 !important;" [attr.colspan]="details_keyColcount" *ngIf="details_keyColcount!=0"  class="columnColor"></th>

                                    <ng-container *ngFor="let eachMonth of monthYearList">
                                        <th style="padding: 0 !important;" class="columnColor" colSpan="2">NOP</th>
                                        <th style="padding: 0 !important;" class="columnColor" colSpan="2">PREMIUM</th>

                                    </ng-container>

                                  
                                </tr>
                                
                            </thead> -->

                            <thead>
                              <tr>
                                <ng-container *ngFor="let col of details_mainColList">
                                    <th class="columnColor">{{col}}</th>
                                </ng-container>

                                <ng-container *ngFor="let eachMonth of monthYearList">
                                    <th class="columnColor" >NOP</th>
                                    <th class="columnColor" >LYFTM GROWTH</th>

                                    <th class="columnColor" >PREMIUM</th>
                                    <th class="columnColor" >LYFTM GROWTH</th>

                                </ng-container>
    
    
    
<!--     
                                <th scope="col"  class="columnColor">YTD PREM</th>
                                <th scope="col"  class="columnColor">LYTD PREM</th>
                                <th scope="col"  class="columnColor">% GROWTH</th>
                                <th scope="col"  class="columnColor">Trend</th>
    
                                <th scope="col"  class="columnColor">MTD PREM</th>
                                <th scope="col"  class="columnColor">LYMTD PREM</th>
                                <th scope="col"  class="columnColor">% GROWTH</th>
                                <th scope="col"  class="columnColor">Trend</th>
                                <th scope="col"  class="columnColor">CYLMTD PREM</th>
                                <th scope="col"  class="columnColor">% GROWTH</th>
                                <th scope="col"  class="columnColor">Trend</th>
    
                                <th scope="col"  class="columnColor">YTD NOP</th>
                                <th scope="col"  class="columnColor">LYTD NOP</th>
                                <th scope="col"  class="columnColor">% GROWTH</th>
                                <th scope="col"  class="columnColor">Trend</th>
    
                                <th scope="col"  class="columnColor">MTD NOP</th>
                                <th scope="col"  class="columnColor">LYMTD NOP</th>
                                <th scope="col"  class="columnColor">% GROWTH</th>
                                <th scope="col"  class="columnColor">Trend</th>
    
                                <th scope="col"  class="columnColor">CYLMTD NOP</th>
                                <th scope="col"  class="columnColor">% GROWTH</th>
                                <th scope="col"  class="columnColor">Trend</th> -->
                                
                                
                              </tr>
                            </thead>
                            <tbody>
                                <ng-container *ngFor="let rowline of details_filteredResult" >

                                    <tr [ngClass]="(rowline.BUSINESS_CATEGORY == 'Customer Loyalty Total')?'rowColor_CLtotal':''">

                                        <ng-container *ngFor="let col of details_mainColList">
                                            <td class="tableColumnStyle">{{rowline[col]}}</td>
                                        </ng-container>



                                        <ng-container *ngFor="let eachMonth of monthYearList">
                                            <td class="tableColumnStyle">{{rowline[eachMonth + '_NOP']}}</td>
                                            <td class="tableColumnStyle" [ngClass]="(rowline[eachMonth + '_NOP_LYFTM_GROWTH'] >= 0)?'growth':'degrowth'">{{rowline[eachMonth + '_NOP_LYFTM_GROWTH']}}%</td>
                                            <td class="tableColumnStyle">{{rowline[eachMonth + '_PREM']}}</td>
                                            <td class="tableColumnStyle" [ngClass]="(rowline[eachMonth + '_PREM_LYFTM_GROWTH'] >= 0)?'growth':'degrowth'">{{rowline[eachMonth + '_PREM_LYFTM_GROWTH']}}%</td>


        
                                        </ng-container>
                                        
                                      </tr>  

                                </ng-container>                  
                              
                            </tbody>
                          </table>
                    </div>

                    
                </div>
                
                

            </div>
            
           
        </div>
    </div>
</ng-container>



<!-- -----------loading screen----------- -->
<div *ngIf="loadingStatus" class="loading" style="z-index: 1; width: 100%; height:100%; background-color: rgba(0, 0, 0, 0.589); position: fixed; top:0%; left: 0%;">
    <div class="text-center" style="padding-top: 22%; display: flex; justify-content: center; align-items: center;">
        <!-- <mat-spinner   color="cyan"></mat-spinner> -->
        <div class="spinner-border text-light" style="width: 3rem; height: 3rem;" role="status">
            <span class="sr-only">Loading...</span>
        </div>
    </div>   
</div>



